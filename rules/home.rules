// Imports
import org.openhab.core.library.types.*
import org.openhab.core.persistence.*
import org.openhab.model.script.actions.*

// Global Variables
var Timer _timer = null
var boolean isTimer = false		


rule "Bedroom Lamp Controller"
when
    Item iMotionBedroom changed
then
	
	if(iMotionBedroom.state == ON) {
	
		sendCommand(iMotionBedroom, OFF)  
		
		if(iLampBedroom.state == OFF) {
			sendCommand(iLampBedroom, ON)
		}
    
    	if(_timer != null) {
    		_timer.cancel()
    		_timer = null
    	}
    	
		_timer = createTimer(now.plusSeconds(5)) [|
		sendCommand(iLampBedroom, OFF)
		isTimer = false;
  		]
      
  	}
 
end